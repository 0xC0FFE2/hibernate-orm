
/*
 * Hibernate, Relational Persistence for Idiomatic Java
 *
 * License: GNU Lesser General Public License (LGPL), version 2.1 or later
 * See the lgpl.txt file in the root directory or http://www.gnu.org/licenses/lgpl-2.1.html
 */
apply from: rootProject.file( 'gradle/java-module.gradle' )
apply from: rootProject.file( 'gradle/publishing-pom.gradle' )

configurations {
    jakartaeeTransformTool {
        description = 'JakartaTransformer tool dependencies'
    }
    tests {
        description = 'Configuration for the produced test jar'
    }
}

dependencies {
    jakartaeeTransformTool 'org.eclipse.transformer:org.eclipse.transformer:0.2.0'
    jakartaeeTransformTool 'org.eclipse.transformer:org.eclipse.transformer.cli:0.2.0'
}

tasks.withType( Test ) { test ->
    test.usesService( project.gradle.sharedServices.registrations.getByName( 'databaseService' ).service )
}

publishing {
    publications {
        publishedArtifacts {
            from components.java
        }
    }
}

java {
    withJavadocJar()
    withSourcesJar()
}


// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// Release / publishing tasks

task ciBuild( dependsOn: [test, publish] )

task release(dependsOn: [test, publishToSonatype])
publishToSonatype.mustRunAfter test


